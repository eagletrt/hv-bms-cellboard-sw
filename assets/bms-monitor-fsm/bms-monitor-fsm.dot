digraph "fsm" {
    bgcolor="white"
    layout="dot"
    center=true
    concentrate=false
    // splines="ortho"

    /* Main operations */
    init
    write_configuration
    read_configuration

    /* Read voltages */
    start_volt_conversion
    poll_volt_status
    read_voltage

    /* Read temperatures */
    start_temp_conversion
    poll_temp_status
    read_temperature

    /* Open wire */
    start_open_wire_pup_conversion
    poll_open_wire_pup_status
    read_open_wire_pup
    start_open_wire_pud_conversion
    poll_open_wire_pud_status
    read_open_wire_pud
    
    /* Initialization */
    init -> write_configuration

    /* Main operations */
    write_configuration -> read_configuration
    write_configuration -> start_volt_conversion
    write_configuration -> start_temp_conversion
    write_configuration -> start_open_wire_pup_conversion

    read_configuration -> write_configuration
    read_configuration -> start_volt_conversion
    read_configuration -> start_temp_conversion
    read_configuration -> start_open_wire_pup_conversion

    /* Read voltages */
    start_volt_conversion -> poll_volt_status 
    start_volt_conversion -> write_configuration

    poll_volt_status -> poll_volt_status
    poll_volt_status -> read_voltage [label="reset_poll_err_counter"]
    poll_volt_status -> write_configuration [label="reset_poll_err_counter"]

    read_voltage -> read_voltage
    read_voltage -> write_configuration

    /* Read temperatures */
    start_temp_conversion -> poll_temp_status
    start_temp_conversion -> write_configuration

    poll_temp_status -> poll_temp_status
    poll_temp_status -> read_temperature [label="reset_poll_err_counter"]
    poll_temp_status -> write_configuration [label="reset_poll_err_counter"]

    read_temperature -> read_temperature
    read_temperature -> write_configuration

    /* Open wire */
    start_open_wire_pup_conversion -> start_open_wire_pup_conversion
    start_open_wire_pup_conversion -> poll_open_wire_pup_status
    start_open_wire_pup_conversion -> write_configuration

    poll_open_wire_pup_status -> poll_open_wire_pup_status
    poll_open_wire_pup_status -> start_open_wire_pup_conversion [label="reset_poll_err_counter"]
    poll_open_wire_pup_status -> read_open_wire_pup [label="reset_poll_err_counter"]
    poll_open_wire_pup_status -> write_configuration [label="reset_poll_err_counter"]

    read_open_wire_pup -> read_open_wire_pup
    read_open_wire_pup -> start_open_wire_pud_conversion
    read_open_wire_pup -> write_configuration

    start_open_wire_pud_conversion -> start_open_wire_pud_conversion
    start_open_wire_pud_conversion -> poll_open_wire_pud_status
    start_open_wire_pud_conversion -> write_configuration

    poll_open_wire_pud_status -> start_open_wire_pud_conversion [label="reset_poll_err_counter"]
    poll_open_wire_pud_status -> poll_open_wire_pud_status
    poll_open_wire_pud_status -> read_open_wire_pud [label="reset_poll_err_counter"]
    poll_open_wire_pud_status -> write_configuration [label="reset_poll_err_counter"]

    read_open_wire_pud -> read_open_wire_pud
    read_open_wire_pud -> write_configuration [label="check_open_wire"]
    read_open_wire_pud -> read_configuration
}
